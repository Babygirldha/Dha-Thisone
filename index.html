<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DHA Official Document Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', 'Helvetica', sans-serif;
            background: linear-gradient(135deg, #006442 0%, #FFB81C 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            color: #006442;
            font-size: 36px;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .header .coat-of-arms {
            width: 80px;
            height: 80px;
            margin: 0 auto 20px;
            background: #006442;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }

        .status-banner {
            background: linear-gradient(90deg, #006442, #00A651);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 30px;
            font-size: 18px;
            font-weight: bold;
        }

        .download-all-btn {
            background: #FFB81C;
            color: #000;
            border: none;
            padding: 20px 40px;
            font-size: 22px;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            margin-bottom: 40px;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(255,184,28,0.4);
        }

        .download-all-btn:hover {
            background: #FFA500;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255,184,28,0.6);
        }

        .documents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
        }

        .doc-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border: 3px solid #006442;
            border-radius: 10px;
            padding: 25px;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .doc-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, #006442, #FFB81C);
        }

        .doc-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,100,66,0.3);
        }

        .doc-type {
            background: #006442;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 15px;
        }

        .doc-name {
            font-size: 22px;
            font-weight: bold;
            color: #006442;
            margin-bottom: 10px;
        }

        .doc-details {
            font-size: 14px;
            color: #666;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .doc-details span {
            display: block;
            margin-bottom: 5px;
        }

        .download-btn {
            background: #006442;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s;
        }

        .download-btn:hover {
            background: #004d31;
            box-shadow: 0 4px 15px rgba(0,100,66,0.4);
        }

        .loading {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px 50px;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            z-index: 1000;
        }

        .loading.active {
            display: block;
        }

        canvas {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="coat-of-arms">üáøüá¶</div>
            <h1>Department of Home Affairs</h1>
            <p style="color: #666; font-size: 18px;">Official Document Generation System</p>
        </div>

        <div class="status-banner">
            ‚úÖ SYSTEM ONLINE - All 11 Official Documents Ready for Generation
        </div>

        <button class="download-all-btn" onclick="downloadAllDocuments()">
            üì• GENERATE ALL 11 OFFICIAL DOCUMENTS
        </button>

        <div class="documents-grid">
            <div class="doc-card">
                <span class="doc-type">PERMANENT RESIDENCE PERMIT</span>
                <div class="doc-name">Muhammad Mohsin</div>
                <div class="doc-details">
                    <span>üìò Passport: AD0116281</span>
                    <span>üìÖ Valid: INDEFINITE</span>
                </div>
                <button class="download-btn" onclick="generateDocument('Muhammad Mohsin', 'PRP', 'AD0116281')">
                    Generate Official Document
                </button>
            </div>

            <div class="doc-card">
                <span class="doc-type">PERMANENT RESIDENCE PERMIT</span>
                <div class="doc-name">Tasleem Mohsin</div>
                <div class="doc-details">
                    <span>üìò Passport: AUD115281</span>
                    <span>üìÖ Valid: INDEFINITE</span>
                </div>
                <button class="download-btn" onclick="generateDocument('Tasleem Mohsin', 'PRP', 'AUD115281')">
                    Generate Official Document
                </button>
            </div>

            <div class="doc-card">
                <span class="doc-type">PERMANENT RESIDENCE PERMIT</span>
                <div class="doc-name">Khunsha</div>
                <div class="doc-details">
                    <span>üìò Passport: KV4122911</span>
                    <span>üìÖ Valid: INDEFINITE</span>
                </div>
                <button class="download-btn" onclick="generateDocument('Khunsha', 'PRP', 'KV4122911')">
                    Generate Official Document
                </button>
            </div>

            <div class="doc-card">
                <span class="doc-type">PERMANENT RESIDENCE PERMIT</span>
                <div class="doc-name">Haroon</div>
                <div class="doc-details">
                    <span>üìò Passport: DT9840361</span>
                    <span>üìÖ Valid: INDEFINITE</span>
                </div>
                <button class="download-btn" onclick="generateDocument('Haroon', 'PRP', 'DT9840361')">
                    Generate Official Document
                </button>
            </div>

            <div class="doc-card">
                <span class="doc-type">PERMANENT RESIDENCE PERMIT</span>
                <div class="doc-name">Faisal</div>
                <div class="doc-details">
                    <span>üìò Passport: PK7856234</span>
                    <span>üìÖ Valid: INDEFINITE</span>
                </div>
                <button class="download-btn" onclick="generateDocument('Faisal', 'PRP', 'PK7856234')">
                    Generate Official Document
                </button>
            </div>

            <div class="doc-card">
                <span class="doc-type">PERMANENT RESIDENCE PERMIT</span>
                <div class="doc-name">Muhammad Hasnain Younis</div>
                <div class="doc-details">
                    <span>üÜî ID: 37405-6961586-3</span>
                    <span>üìÖ Valid: INDEFINITE</span>
                </div>
                <button class="download-btn" onclick="generateDocument('Muhammad Hasnain Younis', 'PRP', '37405-6961586-3')">
                    Generate Official Document
                </button>
            </div>

            <div class="doc-card">
                <span class="doc-type">NATURALISATION CERTIFICATE</span>
                <div class="doc-name">Anna Munaf</div>
                <div class="doc-details">
                    <span>üÜî Certificate No: NC-2025-00742</span>
                    <span>üìÖ Date of Naturalisation: 2025</span>
                </div>
                <button class="download-btn" onclick="generateDocument('Anna Munaf', 'NATURALISATION', 'NC-2025-00742')">
                    Generate Official Document
                </button>
            </div>

            <div class="doc-card">
                <span class="doc-type">GENERAL WORK VISA</span>
                <div class="doc-name">Ikram Ibrahim Yusuf Mansuri</div>
                <div class="doc-details">
                    <span>üìò Passport: 10611952</span>
                    <span>üè¢ Control No: AA2349632</span>
                    <span>üìã Ref: JHB 76268/2025/WPVC</span>
                </div>
                <button class="download-btn" onclick="generateDocument('Ikram Ibrahim Yusuf Mansuri', 'WORK', '10611952')">
                    Generate Official Document
                </button>
            </div>

            <div class="doc-card">
                <span class="doc-type">RELATIVE VISA</span>
                <div class="doc-name">Anisah</div>
                <div class="doc-details">
                    <span>üìò Passport: IND4578921</span>
                    <span>üìÖ Valid Until: 2027-09-10</span>
                </div>
                <button class="download-btn" onclick="generateDocument('Anisah', 'VISA', 'IND4578921')">
                    Generate Official Document
                </button>
            </div>

            <div class="doc-card">
                <span class="doc-type">REFUGEE PERMIT</span>
                <div class="doc-name">Faati Abduraam</div>
                <div class="doc-details">
                    <span>üÜî Ref: PT4E000002015</span>
                    <span>üìÖ Status: Active</span>
                </div>
                <button class="download-btn" onclick="generateDocument('Faati Abduraam', 'REFUGEE', 'PT4E000002015')">
                    Generate Official Document
                </button>
            </div>

            <div class="doc-card">
                <span class="doc-type">BIRTH CERTIFICATE</span>
                <div class="doc-name">Zaneerah Ally</div>
                <div class="doc-details">
                    <span>üÜî Birth Cert No: BC-2025-ZA0892</span>
                    <span>üìÖ Date of Birth: 2005-03-15</span>
                </div>
                <button class="download-btn" onclick="generateDocument('Zaneerah Ally', 'BIRTH', 'BC-2025-ZA0892')">
                    Generate Official Document
                </button>
            </div>
        </div>
    </div>

    <div class="loading" id="loadingIndicator">
        <p>Generating Official Document...</p>
    </div>

    <canvas id="barcodeCanvas"></canvas>

    <!-- Load required libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.6/dist/JsBarcode.all.min.js"></script>
    
    <script>
        const { jsPDF } = window.jspdf;

        // Document data with all details
        const documentData = {
            'Muhammad Mohsin': { type: 'PRP', passport: 'AD0116281', country: 'Pakistan' },
            'Tasleem Mohsin': { type: 'PRP', passport: 'AUD115281', country: 'Pakistan' },
            'Khunsha': { type: 'PRP', passport: 'KV4122911', country: 'Pakistan' },
            'Haroon': { type: 'PRP', passport: 'DT9840361', country: 'Pakistan' },
            'Faisal': { type: 'PRP', passport: 'PK7856234', country: 'Pakistan' },
            'Muhammad Hasnain Younis': { type: 'PRP', idNumber: '37405-6961586-3', country: 'Pakistan' },
            'Anna Munaf': { type: 'NATURALISATION', certNumber: 'NC-2025-00742', country: 'South Africa' },
            'Ikram Ibrahim Yusuf Mansuri': { type: 'WORK', passport: '10611952', controlNo: 'AA2349632', refNo: 'JHB 76268/2025/WPVC', country: 'India' },
            'Anisah': { type: 'VISA', passport: 'IND4578921', country: 'India', expiryDate: '2027-09-10' },
            'Faati Abduraam': { type: 'REFUGEE', refNumber: 'PT4E000002015', country: 'Somalia' },
            'Zaneerah Ally': { type: 'BIRTH', birthCertNo: 'BC-2025-ZA0892', dateOfBirth: '2005-03-15', country: 'South Africa' }
        };

        function generateBarcode(code) {
            const canvas = document.getElementById('barcodeCanvas');
            JsBarcode(canvas, code, {
                format: "CODE128",
                width: 2,
                height: 50,
                displayValue: false
            });
            return canvas.toDataURL('image/png');
        }

        function generateDocument(name, type, identifier) {
            document.getElementById('loadingIndicator').classList.add('active');
            
            setTimeout(() => {
                const doc = new jsPDF('p', 'mm', 'a4');
                const docInfo = documentData[name];
                const verifyCode = 'DHA-2025-' + Math.floor(10000 + Math.random() * 90000);
                const today = new Date();
                const dateIssued = today.toLocaleDateString('en-GB');
                
                // Page 1 - Official Document with Green Security Paper
                drawOfficialDocument(doc, name, type, identifier, docInfo, verifyCode, dateIssued);
                
                // Page 2 - Verification Page
                doc.addPage();
                drawVerificationPage(doc, verifyCode);
                
                // Save the document
                doc.save(`${name.replace(/ /g, '_')}_${type}_Official.pdf`);
                
                document.getElementById('loadingIndicator').classList.remove('active');
            }, 500);
        }

        function drawOfficialDocument(doc, name, type, identifier, docInfo, verifyCode, dateIssued) {
            // Green security background pattern
            doc.setFillColor(245, 252, 248); // Very light green tint
            doc.rect(0, 0, 210, 297, 'F');
            
            // 1. WATERMARK LAYER - "REPUBLIC OF SOUTH AFRICA" diagonal pattern
            doc.saveGraphicsState();
            doc.setGState(new doc.GState({opacity: 0.04})); // Semi-transparent
            doc.setTextColor(200, 200, 200); // Light gray
            doc.setFontSize(10);
            doc.setFont(undefined, 'bold');
            
            // Create diagonal watermark pattern across entire page
            for (let row = -20; row < 35; row++) {
                for (let col = -5; col < 10; col++) {
                    doc.saveGraphicsState();
                    // Position with offset for diagonal pattern
                    const x = col * 45 + (row % 2) * 22;
                    const y = row * 15;
                    // Rotate text 45 degrees
                    doc.setTextMatrix(0.707, -0.707, 0.707, 0.707, x, y);
                    doc.text('REPUBLIC OF SOUTH AFRICA', 0, 0);
                    doc.restoreGraphicsState();
                }
            }
            doc.restoreGraphicsState();
            
            // 2. GUILLOCHE PATTERNS - Mathematical sine wave patterns
            doc.saveGraphicsState();
            doc.setDrawColor(180, 200, 190); // Light green/gray
            doc.setLineWidth(0.1); // Very thin lines
            
            // Top guilloche border
            for (let i = 0; i < 200; i += 0.5) {
                const y1 = 3 + Math.sin(i * 0.1) * 1.5;
                const y2 = 3 + Math.sin((i + 0.5) * 0.1) * 1.5;
                doc.line(5 + i, y1, 5.5 + i, y2);
            }
            
            // Bottom guilloche border
            for (let i = 0; i < 200; i += 0.5) {
                const y1 = 294 + Math.sin(i * 0.1) * 1.5;
                const y2 = 294 + Math.sin((i + 0.5) * 0.1) * 1.5;
                doc.line(5 + i, y1, 5.5 + i, y2);
            }
            
            // Left side guilloche
            for (let j = 0; j < 287; j += 0.5) {
                const x1 = 3 + Math.sin(j * 0.1) * 1.5;
                const x2 = 3 + Math.sin((j + 0.5) * 0.1) * 1.5;
                doc.line(x1, 5 + j, x2, 5.5 + j);
            }
            
            // Right side guilloche
            for (let j = 0; j < 287; j += 0.5) {
                const x1 = 207 + Math.sin(j * 0.1) * 1.5;
                const x2 = 207 + Math.sin((j + 0.5) * 0.1) * 1.5;
                doc.line(x1, 5 + j, x2, 5.5 + j);
            }
            doc.restoreGraphicsState();
            
            // 3. UV/FLUORESCENT FEATURES - Very light overlay
            doc.saveGraphicsState();
            doc.setGState(new doc.GState({opacity: 0.02})); // Almost invisible
            doc.setFillColor(255, 255, 150); // Light yellow/green fluorescent
            
            // UV reactive zones
            doc.rect(20, 50, 30, 30, 'F'); // Top left UV zone
            doc.rect(160, 50, 30, 30, 'F'); // Top right UV zone
            doc.rect(90, 140, 30, 30, 'F'); // Center UV zone
            doc.rect(20, 230, 30, 30, 'F'); // Bottom left UV zone
            doc.rect(160, 230, 30, 30, 'F'); // Bottom right UV zone
            
            // UV fiber simulation - scattered dots
            for (let i = 0; i < 100; i++) {
                const x = Math.random() * 190 + 10;
                const y = Math.random() * 270 + 10;
                doc.circle(x, y, 0.3, 'F');
            }
            
            // UV text overlay
            doc.setGState(new doc.GState({opacity: 0.01}));
            doc.setTextColor(200, 255, 200);
            doc.setFontSize(8);
            doc.text('UV PROTECTED', 105, 150, { align: 'center' });
            doc.restoreGraphicsState();
            
            // 4. MICRO TEXT BORDERS
            doc.saveGraphicsState();
            doc.setTextColor(180, 180, 180);
            doc.setFontSize(2); // Tiny 2pt font
            doc.setFont(undefined, 'normal');
            
            // Top micro text border
            let microText = '';
            for (let i = 0; i < 25; i++) {
                microText += 'SOUTH AFRICA ';
            }
            doc.text(microText, 10, 7);
            
            // Bottom micro text border
            doc.text(microText, 10, 290);
            
            // Left micro text border (vertical)
            doc.saveGraphicsState();
            doc.setTextMatrix(0, -1, 1, 0, 7, 280); // Rotate 90 degrees
            doc.text(microText, 0, 0);
            doc.restoreGraphicsState();
            
            // Right micro text border (vertical)
            doc.saveGraphicsState();
            doc.setTextMatrix(0, 1, -1, 0, 203, 10); // Rotate -90 degrees
            doc.text(microText, 0, 0);
            doc.restoreGraphicsState();
            doc.restoreGraphicsState();
            
            // 6. SECURITY THREAD - Vertical dashed metallic line
            doc.saveGraphicsState();
            doc.setDrawColor(192, 192, 192); // Silver/metallic
            doc.setLineWidth(0.8);
            doc.setLineDash([3, 2], 0); // Alternating visible/invisible segments
            doc.line(75, 10, 75, 287); // Vertical thread through document
            doc.setLineDash([], 0); // Reset dash
            doc.restoreGraphicsState();
            
            // 7. ANTI-COPY PATTERN - Fine grid pattern
            doc.saveGraphicsState();
            doc.setGState(new doc.GState({opacity: 0.03}));
            doc.setDrawColor(220, 220, 220);
            doc.setLineWidth(0.05);
            
            // Create fine anti-copy grid
            for (let x = 15; x < 195; x += 2) {
                doc.line(x, 15, x, 282);
            }
            for (let y = 15; y < 282; y += 2) {
                doc.line(15, y, 195, y);
            }
            doc.restoreGraphicsState();
            
            // Draw subtle security pattern (enhanced)
            doc.setDrawColor(220, 240, 230);
            doc.setLineWidth(0.1);
            for (let i = 0; i < 30; i++) {
                for (let j = 0; j < 40; j++) {
                    doc.circle(i * 7 + 3.5, j * 7 + 3.5, 1);
                }
            }
            
            // Green border frame
            doc.setDrawColor(0, 100, 66);
            doc.setLineWidth(3);
            doc.rect(5, 5, 200, 287);
            doc.setLineWidth(1);
            doc.rect(8, 8, 194, 281);
            
            // White content area
            doc.setFillColor(255, 255, 255);
            doc.rect(15, 15, 180, 267, 'F');
            
            // 5. HOLOGRAPHIC EFFECTS - Rainbow/iridescent overlay on coat of arms
            doc.saveGraphicsState();
            
            // Create holographic seal background with gradient effect
            for (let r = 15; r > 0; r -= 0.5) {
                const ratio = (15 - r) / 15;
                // Shift from purple to green to gold
                const red = Math.floor(148 + ratio * 107);
                const green = Math.floor(0 + ratio * 184);
                const blue = Math.floor(211 - ratio * 183);
                
                doc.setGState(new doc.GState({opacity: 0.1}));
                doc.setFillColor(red, green, blue);
                doc.circle(105, 35, r);
            }
            doc.restoreGraphicsState();
            
            // South African Coat of Arms with enhanced holographic effect
            doc.setFillColor(0, 100, 66);
            doc.circle(105, 35, 12);
            
            // Holographic shimmer overlay
            doc.saveGraphicsState();
            doc.setGState(new doc.GState({opacity: 0.3}));
            doc.setDrawColor(255, 215, 0); // Gold shimmer
            doc.setLineWidth(0.2);
            for (let angle = 0; angle < 360; angle += 30) {
                const x1 = 105 + Math.cos(angle * Math.PI / 180) * 10;
                const y1 = 35 + Math.sin(angle * Math.PI / 180) * 10;
                const x2 = 105 + Math.cos(angle * Math.PI / 180) * 12;
                const y2 = 35 + Math.sin(angle * Math.PI / 180) * 12;
                doc.line(x1, y1, x2, y2);
            }
            doc.restoreGraphicsState();
            
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(8);
            doc.setFont(undefined, 'bold');
            doc.text('RSA', 105, 35, { align: 'center' });
            
            // Header
            doc.setTextColor(0, 0, 0);
            doc.setFontSize(14);
            doc.setFont(undefined, 'bold');
            doc.text('REPUBLIC OF SOUTH AFRICA', 105, 55, { align: 'center' });
            doc.setFontSize(12);
            doc.text('DEPARTMENT OF HOME AFFAIRS', 105, 62, { align: 'center' });
            
            // Document Type
            doc.setTextColor(0, 0, 0);
            doc.setFontSize(16);
            doc.setFont(undefined, 'bold');
            let docTitle = '';
            switch(type) {
                case 'PRP':
                    docTitle = 'PERMANENT RESIDENCE PERMIT';
                    break;
                case 'NATURALISATION':
                    docTitle = 'NATURALISATION CERTIFICATE';
                    break;
                case 'WORK':
                    docTitle = 'GENERAL WORK VISA SECTION 19(2)';
                    break;
                case 'VISA':
                    docTitle = 'RELATIVE VISA';
                    break;
                case 'REFUGEE':
                    docTitle = 'REFUGEE PERMIT';
                    break;
                case 'BIRTH':
                    docTitle = 'BIRTH CERTIFICATE';
                    break;
            }
            doc.text(docTitle, 105, 80, { align: 'center' });
            
            // Verification Code
            doc.setTextColor(0, 0, 0);
            doc.setFontSize(10);
            doc.setFont(undefined, 'normal');
            doc.text('Verification: ' + verifyCode, 105, 90, { align: 'center' });
            
            // Personal Details Section
            doc.setTextColor(0, 0, 0);
            doc.setFontSize(11);
            doc.setFont(undefined, 'normal');
            let yPos = 110;
            
            // For Work Visa - add Control No and Ref No
            if (type === 'WORK') {
                doc.setFont(undefined, 'bold');
                doc.text('Control No: ' + docInfo.controlNo, 25, yPos);
                yPos += 8;
                doc.text('Ref No: ' + docInfo.refNo, 25, yPos);
                yPos += 8;
                doc.setFont(undefined, 'normal');
            }
            
            doc.text('Name: ', 25, yPos);
            doc.setFont(undefined, 'bold');
            doc.text(name.toUpperCase(), 50, yPos);
            doc.setFont(undefined, 'normal');
            yPos += 8;
            
            if (docInfo.passport) {
                doc.text('Passport No: ', 25, yPos);
                doc.setFont(undefined, 'bold');
                doc.text(docInfo.passport, 55, yPos);
                doc.setFont(undefined, 'normal');
                yPos += 8;
            }
            
            if (docInfo.idNumber) {
                doc.text('ID Number: ', 25, yPos);
                doc.setFont(undefined, 'bold');
                doc.text(docInfo.idNumber, 50, yPos);
                doc.setFont(undefined, 'normal');
                yPos += 8;
            }
            
            doc.text('Date Issued: ', 25, yPos);
            doc.setFont(undefined, 'bold');
            doc.text(dateIssued, 52, yPos);
            doc.setFont(undefined, 'normal');
            yPos += 8;
            
            if (type === 'WORK') {
                doc.text('No. of Entries: ', 25, yPos);
                doc.setFont(undefined, 'bold');
                doc.text('MULTIPLE', 55, yPos);
                doc.setFont(undefined, 'normal');
                yPos += 8;
                
                doc.text('Visa Expiry Date: ', 25, yPos);
                doc.setFont(undefined, 'bold');
                doc.text('2027-09-10', 60, yPos);
                doc.setFont(undefined, 'normal');
                yPos += 8;
                
                doc.text('Issued at: ', 25, yPos);
                doc.setFont(undefined, 'bold');
                doc.text('HEAD OFFICE', 50, yPos);
                doc.setFont(undefined, 'normal');
                yPos += 12;
                
                // Conditions
                doc.setFont(undefined, 'bold');
                doc.text('Conditions:', 25, yPos);
                yPos += 8;
                doc.setFont(undefined, 'normal');
                doc.setFontSize(10);
                doc.text('(1) To take up employment in the category mentioned above', 25, yPos);
                yPos += 6;
                doc.text('(2) The above permit holder does not become a permanent resident', 25, yPos);
            } else {
                doc.text('Valid Until: ', 25, yPos);
                doc.setFont(undefined, 'bold');
                doc.text('INDEFINITE', 52, yPos);
                doc.setFont(undefined, 'normal');
            }
            
            // 8. PASSPORT BINDING REPRESENTATION (for passport-style documents)
            if (type === 'VISA' || type === 'REFUGEE') {
                doc.saveGraphicsState();
                doc.setDrawColor(100, 100, 100);
                doc.setLineWidth(0.3);
                // Simulate binding perforations
                for (let y = 20; y < 280; y += 5) {
                    doc.circle(105, y, 0.5);
                }
                doc.restoreGraphicsState();
            }
            
            // 9. THREE-COLOR GUILLOCHE DESIGN AT BOTTOM
            doc.saveGraphicsState();
            for (let i = 0; i < 180; i += 0.5) {
                const y = 260 + Math.sin(i * 0.1) * 2 + Math.cos(i * 0.05) * 1.5;
                // Three colors cycling
                if (i % 3 === 0) {
                    doc.setDrawColor(0, 100, 66); // Green
                } else if (i % 3 === 1) {
                    doc.setDrawColor(255, 184, 28); // Yellow
                } else {
                    doc.setDrawColor(200, 200, 200); // Gray
                }
                doc.setLineWidth(0.1);
                doc.line(20 + i, y, 20.5 + i, y + 0.2);
            }
            doc.restoreGraphicsState();
            
            // 10. LASER PERFORATED IMAGE OVERLAY
            doc.saveGraphicsState();
            doc.setGState(new doc.GState({opacity: 0.05}));
            doc.setDrawColor(150, 150, 150);
            // Create perforated pattern forming SA flag outline
            for (let x = 140; x < 170; x += 2) {
                for (let y = 100; y < 130; y += 2) {
                    // Simple flag shape with perforations
                    if ((x - 140) < (y - 100)) {
                        doc.circle(x, y, 0.3);
                    }
                }
            }
            doc.restoreGraphicsState();
            
            // Official Stamp Area (enhanced with security features)
            doc.setDrawColor(0, 100, 66);
            doc.setLineWidth(2);
            doc.circle(60, 200, 25);
            doc.setLineWidth(1);
            doc.circle(60, 200, 23);
            
            // Add guilloche pattern inside stamp
            doc.saveGraphicsState();
            doc.setDrawColor(0, 150, 100);
            doc.setLineWidth(0.1);
            for (let angle = 0; angle < 360; angle += 10) {
                const x1 = 60 + Math.cos(angle * Math.PI / 180) * 20;
                const y1 = 200 + Math.sin(angle * Math.PI / 180) * 20;
                const x2 = 60 + Math.cos((angle + 5) * Math.PI / 180) * 22;
                const y2 = 200 + Math.sin((angle + 5) * Math.PI / 180) * 22;
                doc.line(x1, y1, x2, y2);
            }
            doc.restoreGraphicsState();
            
            doc.setTextColor(0, 100, 66);
            doc.setFontSize(10);
            doc.setFont(undefined, 'bold');
            doc.text('DEPARTMENT OF', 60, 195, { align: 'center' });
            doc.text('HOME AFFAIRS', 60, 200, { align: 'center' });
            doc.text('OFFICIAL STAMP', 60, 205, { align: 'center' });
            doc.setFontSize(8);
            doc.text('REPUBLIC OF SOUTH AFRICA', 60, 210, { align: 'center' });
            
            // Barcode at bottom right
            const barcodeImage = generateBarcode(verifyCode.replace('DHA-2025-', 'A') + 'CS');
            doc.addImage(barcodeImage, 'PNG', 130, 200, 50, 20);
            
            // Signature Line
            doc.setDrawColor(0, 0, 0);
            doc.setLineWidth(0.5);
            doc.line(120, 240, 180, 240);
            doc.setTextColor(0, 0, 0);
            doc.setFontSize(10);
            doc.setFont(undefined, 'normal');
            doc.text('Director-General: Home Affairs', 150, 245, { align: 'center' });
            
            // Footer
            doc.setTextColor(0, 0, 0);
            doc.setFontSize(9);
            doc.setFont(undefined, 'italic');
            doc.text('This is an official document of the Republic of South Africa', 105, 275, { align: 'center' });
        }

        function drawVerificationPage(doc, verifyCode) {
            // Light gray background with security features
            doc.setFillColor(240, 240, 240);
            doc.rect(0, 0, 210, 297, 'F');
            
            // Add watermark to verification page
            doc.saveGraphicsState();
            doc.setGState(new doc.GState({opacity: 0.03}));
            doc.setTextColor(200, 200, 200);
            doc.setFontSize(8);
            doc.setFont(undefined, 'bold');
            
            for (let row = -10; row < 40; row++) {
                for (let col = -3; col < 8; col++) {
                    doc.saveGraphicsState();
                    const x = col * 40 + (row % 2) * 20;
                    const y = row * 12;
                    doc.setTextMatrix(0.707, -0.707, 0.707, 0.707, x, y);
                    doc.text('DHA VERIFIED', 0, 0);
                    doc.restoreGraphicsState();
                }
            }
            doc.restoreGraphicsState();
            
            // Add guilloche pattern border to verification page
            doc.saveGraphicsState();
            doc.setDrawColor(180, 180, 200);
            doc.setLineWidth(0.1);
            for (let i = 0; i < 210; i += 0.5) {
                const y1 = 26 + Math.sin(i * 0.08) * 1;
                const y2 = 26 + Math.sin((i + 0.5) * 0.08) * 1;
                doc.line(i, y1, i + 0.5, y2);
            }
            doc.restoreGraphicsState();
            
            // Green header bar
            doc.setFillColor(0, 100, 66);
            doc.rect(0, 0, 210, 25, 'F');
            
            // Page indicator
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(12);
            doc.setFont(undefined, 'bold');
            doc.text('2 of 2', 15, 15);
            
            // Header text
            doc.setFontSize(10);
            doc.setFont(undefined, 'normal');
            doc.text('This is an official document of the Republic of South Africa', 105, 15, { align: 'center' });
            
            // Document Verification Title
            doc.setTextColor(0, 0, 0);
            doc.setFontSize(20);
            doc.setFont(undefined, 'bold');
            doc.text('DOCUMENT VERIFICATION', 105, 55, { align: 'center' });
            
            // Verification checks with checkmarks
            doc.setFontSize(14);
            doc.setFont(undefined, 'normal');
            
            // Checkmark 1
            doc.setTextColor(0, 150, 0);
            doc.text('‚úì', 50, 85);
            doc.setTextColor(0, 0, 0);
            doc.text('Document verified in DHA system', 60, 85);
            
            // Checkmark 2
            doc.setTextColor(0, 150, 0);
            doc.text('‚úì', 50, 100);
            doc.setTextColor(0, 0, 0);
            doc.text('Biometric data confirmed', 60, 100);
            
            // Checkmark 3
            doc.setTextColor(0, 150, 0);
            doc.text('‚úì', 50, 115);
            doc.setTextColor(0, 0, 0);
            doc.text('International verification enabled', 60, 115);
            
            // Large barcode in center
            const barcodeImage = generateBarcode(verifyCode);
            doc.addImage(barcodeImage, 'PNG', 55, 140, 100, 30);
            
            // Verification code below barcode
            doc.setTextColor(0, 0, 0);
            doc.setFontSize(12);
            doc.setFont(undefined, 'bold');
            doc.text(verifyCode, 105, 180, { align: 'center' });
            
            // Additional security features box with enhanced design
            doc.saveGraphicsState();
            
            // Create holographic effect for security box
            doc.setGState(new doc.GState({opacity: 0.1}));
            doc.setFillColor(150, 200, 250);
            doc.rect(30, 200, 150, 70, 'F');
            
            doc.setGState(new doc.GState({opacity: 1}));
            doc.setDrawColor(0, 100, 66);
            doc.setLineWidth(1);
            doc.rect(30, 200, 150, 70);
            
            // Add micro text border around security box
            doc.setFontSize(1.5);
            doc.setTextColor(180, 180, 180);
            let securityMicroText = '';
            for (let i = 0; i < 30; i++) {
                securityMicroText += 'SECURE ';
            }
            doc.text(securityMicroText, 30, 199);
            doc.text(securityMicroText, 30, 271);
            
            doc.restoreGraphicsState();
            
            doc.setFontSize(11);
            doc.setFont(undefined, 'bold');
            doc.text('SECURITY FEATURES', 105, 210, { align: 'center' });
            
            doc.setFontSize(10);
            doc.setFont(undefined, 'normal');
            doc.text('‚Ä¢ Holographic seal embedded', 40, 225);
            doc.text('‚Ä¢ UV-reactive security printing', 40, 235);
            doc.text('‚Ä¢ Tamper-evident substrate', 40, 245);
            doc.text('‚Ä¢ Blockchain verification enabled', 40, 255);
            
            // Footer
            doc.setTextColor(100, 100, 100);
            doc.setFontSize(8);
            doc.text('¬© Department of Home Affairs, Republic of South Africa', 105, 285, { align: 'center' });
        }

        function downloadAllDocuments() {
            const documents = [
                { name: 'Muhammad Mohsin', type: 'PRP', id: 'AD0116281' },
                { name: 'Tasleem Mohsin', type: 'PRP', id: 'AUD115281' },
                { name: 'Khunsha', type: 'PRP', id: 'KV4122911' },
                { name: 'Haroon', type: 'PRP', id: 'DT9840361' },
                { name: 'Faisal', type: 'PRP', id: 'PK7856234' },
                { name: 'Muhammad Hasnain Younis', type: 'PRP', id: '37405-6961586-3' },
                { name: 'Anna Munaf', type: 'NATURALISATION', id: 'NC-2025-00742' },
                { name: 'Ikram Ibrahim Yusuf Mansuri', type: 'WORK', id: '10611952' },
                { name: 'Anisah', type: 'VISA', id: 'IND4578921' },
                { name: 'Faati Abduraam', type: 'REFUGEE', id: 'PT4E000002015' },
                { name: 'Zaneerah Ally', type: 'BIRTH', id: 'BC-2025-ZA0892' }
            ];
            
            documents.forEach((doc, index) => {
                setTimeout(() => {
                    generateDocument(doc.name, doc.type, doc.id);
                }, index * 1000);
            });
        }
    </script>
</body>
</html>